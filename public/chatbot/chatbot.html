<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Legal Assistant Chatbot</title>
    <style>
    :root {
        --primary-color: #5e4437;
        --secondary-color: #7a5c4b;
        --accent-color: #865538;
        --bot-bubble: #f5f5f5;
        --user-bubble: #2c3e50;
        --text-light: #ffffff;
        --text-dark: #333333;
        --loading-color: #844623;
        --highlight-color: #a67c52;
        --base-font-size: 16px;
      }
      
      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
        font-family: 'Georgia', 'Times New Roman', serif;
      }
      
      body {
        background: #f5f5f5;
        min-height: 100vh;
        font-size: var(--base-font-size);
      }
      #bg-video {
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  object-fit: cover;
  z-index: -1;
  pointer-events: none; /* Optional: prevents clicks from hitting the video */
}

      .main-container {
  display: flex;
  justify-content: space-between;
  align-items: flex-start;
  gap: 2rem;
  padding: 2rem;
}
@media (max-width: 480px) {
  #bg-video {
    display: none;
    /* or: */
    /* filter: blur(3px); */
  }
}

@media (max-width: 1000px) {
  .main-container {
    flex-direction: column;
    padding: 1rem;
    gap: 1.5rem;
  }

  .left-heading {
    position: relative !important;
    top: auto !important;
    left: auto !important;
    transform: none !important;
    margin: 0 auto;
    width: 100%;
    text-align: center;
  }

  #chatbot-container {
    position: relative !important;
    width: 100%;
    height: auto;
    max-height: 80vh;
    right: auto;
    bottom: auto;
    margin: 0 auto;
  }

  #bg-video {
    height: auto;
    min-height: 100%;
    object-fit: cover;
  }
}



      
      /* LEFT SECTION */
      .left-heading {
        position: absolute;
        top: 50%;
        left: 7%;
        transform: translateY(-50%);
        text-align: left;
        max-width: 30%;
        padding: 2rem;
        background: rgba(255, 255, 255, 0.85);
        border-radius: 1rem;
        box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
        backdrop-filter: blur(8px);
        -webkit-backdrop-filter: blur(8px);
        border: 3px solid rgba(255, 255, 255, 0.18);
        z-index: 1;
        animation: fadeInUp 0.8s ease-out;
      }
      
      .left-heading h1 {
        font-size: clamp(1.5rem, 2.5vw, 2.25rem);
        color: var(--primary-color);
      }
      
      .left-heading p {
        font-size: clamp(0.9rem, 2vw, 1.1rem);
        margin-top: 0.75rem;
        color: var(--text-dark);
      }
      
      .cta-button {
        display: inline-flex;
        align-items: center;
        justify-content: center;
        margin-top: 1.5rem;
        padding: 0.75rem 1.5rem;
        background-color: var(--primary-color);
        color: white;
        text-decoration: none;
        border-radius: 50px;
        font-weight: 600;
        transition: all 0.3s ease;
        box-shadow: 0 4px 15px rgba(94, 68, 55, 0.2);
        font-size: 1rem;
      }
      
      .cta-button:hover {
        background-color: var(--secondary-color);
        transform: translateY(-2px);
        box-shadow: 0 6px 20px rgba(94, 68, 55, 0.3);
      }
      
      .cta-button:active {
        transform: translateY(0);
      }
      
      .emoji-icon {
        font-size: 1.5rem;
        margin-right: 10px;
        line-height: 1;
      }
      
      /* CHATBOT */
      #chatbot-container {
        position: fixed;
        top: 10px;
        bottom: 10px;
        right: 20px;
        width: 100%;
        max-width: 600px;
        height: 95vh;
        background: rgba(255, 255, 255, 0.95);
        border-radius: 8px;
        box-shadow: 0 5px 15px #7a5c4b;
        display: flex;
        flex-direction: column;
        overflow: hidden;
        border: 1px solid #ddd;
        z-index: 1000;
      }
      
      #chatbot-header {
        background: linear-gradient(to right, var(--primary-color), var(--secondary-color));
        color: var(--text-light);
        padding: 1rem;
        text-align: center;
        font-weight: bold;
        font-size: 1.2rem;
        border-bottom: 1px solid rgba(255,255,255,0.1);
        display: flex;
        align-items: center;
        justify-content: center;
      }
      
      #chatbot-header:before {
        content: "üèõÔ∏è";
        margin-right: 10px;
        font-size: 1.5rem;
      }
      
      #chatbot-messages {
        flex: 1;
        padding: 1rem;
        overflow-y: auto;
        background: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="100" height="100" viewBox="0 0 100 100"><rect fill="none" width="100" height="100"/><path fill="rgba(94, 68, 55, 0.03)" d="M50,0 L100,50 L50,100 L0,50 Z"/></svg>');
        background-size: 150px;
        display: flex;
        flex-direction: column;
        gap: 12px;
      }
      
      .message {
        max-width: 85%;
        padding: 0.75rem 1rem;
        border-radius: 8px;
        font-size: 0.95rem;
        line-height: 1.5;
        animation: fadeIn 0.3s ease;
        word-wrap: break-word;
      }
      
      .bot-message {
        align-self: flex-start;
        background-color: var(--bot-bubble);
        color: var(--text-dark);
        border-top-left-radius: 2px;
        border: 1px solid #ddd;
        box-shadow: 0 1px 2px #865538;
      }
      
      .user-message {
        align-self: flex-end;
        background: linear-gradient(to right, var(--primary-color), var(--secondary-color));
        color: white;
        border-top-right-radius: 2px;
        box-shadow: 0 1px 2px #844623;
      }
      
      #chatbot-input-container {
        display: flex;
        flex-direction: column;
        padding: 1rem;
        background: white;
        border-top: 1px solid #eee;
        gap: 0.75rem;
      }
      
      .input-row {
        display: flex;
        gap: 0.75rem;
      }
      
      #chatbot-input {
        flex: 1;
        padding: 0.75rem 1rem;
        font-size: 1rem;
        border: 1px solid #865538;
        border-radius: 4px;
        background: #f9f9f9;
        outline: none;
      }
      
      #chatbot-send {
        background: linear-gradient(to right, var(--primary-color), var(--secondary-color));
        color: white;
        border: none;
        border-radius: 4px;
        width: 45px;
        height: 45px;
        display: flex;
        align-items: center;
        justify-content: center;
        cursor: pointer;
        transition: all 0.2s ease;
      }
      
      #chatbot-send:hover {
        background: var(--secondary-color);
      }
      
      #file-upload-container {
        display: flex;
        align-items: center;
        gap: 0.5rem;
      }
      
      #file-upload-label {
        background: var(--accent-color);
        color: white;
        border-radius: 4px;
        padding: 0.5rem 0.75rem;
        font-size: 0.85rem;
        cursor: pointer;
        display: flex;
        align-items: center;
        gap: 5px;
      }
      
      #file-upload-label:hover {
        background: #7a5c4b;
      }
      
      #file-upload-label:before {
        content: "üìÑ";
      }
      
      #file-upload {
        display: none;
      }
      
      #file-name {
        font-size: 0.8rem;
        color: var(--accent-color);
        flex: 1;
        white-space: nowrap;
        overflow: hidden;
        text-overflow: ellipsis;
      }
      
      .legal-disclaimer {
        font-size: 0.7rem;
        color: #7a5c4b;
        text-align: center;
        padding: 8px;
        background: #f9f9f9;
        border-top: 1px solid #eee;
      }
      
      .document-summary {
        background-color: #f8f9fa;
        border-left: 4px solid var(--highlight-color);
        padding: 10px;
        margin: 10px 0;
        border-radius: 0 4px 4px 0;
      }
      
      .document-summary h4 {
        color: var(--highlight-color);
        margin-bottom: 8px;
        display: flex;
        align-items: center;
        gap: 5px;
      }
      
      .document-summary h4:before {
        content: "üìë";
      }
      
      .loading-dots {
        display: flex;
        padding: 0.75rem 1rem;
        align-self: flex-start;
        background-color: var(--bot-bubble);
        border-radius: 8px;
        box-shadow: 0 1px 2px rgba(0,0,0,0.1);
      }
      
      .loading-dots div {
        width: 8px;
        height: 8px;
        margin: 0 4px;
        background-color: var(--loading-color);
        border-radius: 50%;
        display: inline-block;
        animation: bounce 1.4s infinite ease-in-out both;
      }
      
      .loading-dots div:nth-child(1) { animation-delay: -0.32s; }
      .loading-dots div:nth-child(2) { animation-delay: -0.16s; }
      
      @keyframes fadeInUp {
        from {
          opacity: 0;
          transform: translateY(30px) translateX(-20px);
        }
        to {
          opacity: 1;
          transform: translateY(-50%) translateX(0);
        }
      }
      
      @keyframes fadeIn {
        from {
          opacity: 0;
          transform: translateY(10px);
        }
        to {
          opacity: 1;
          transform: translateY(0);
        }
      }
      
      @keyframes bounce {
        0%, 80%, 100% { transform: scale(0); }
        40% { transform: scale(1); }
      }
      
      /* --- RESPONSIVE MEDIA QUERIES --- */
      @media (max-width: 768px) {
        .left-heading {
          position: relative;
          top: auto;
          left: auto;
          transform: none;
          margin: 2rem auto;
          text-align: center;
          max-width: 90%;
        }
      
        .cta-button {
          font-size: 0.95rem;
          padding: 10px 20px;
        }
      
        #chatbot-container {
          width: 90%;
          height: 75vh;
          bottom: 15px;
          right: 5%;
        }
      
        .message {
          max-width: 90%;
          font-size: 0.9rem;
        }
      }
      
      @media (max-width: 480px) {
        .left-heading h1 {
          font-size: 1.5rem;
        }
      
        #chatbot-container {
          width: 95%;
          height: 80vh;
          right: 2.5%;
        }
      
        .cta-button {
          padding: 0.6rem 1rem;
          font-size: 0.9rem;
        }
      
        #chatbot-header {
          font-size: 1rem;
        }
      
        .emoji-icon {
          font-size: 1.3rem;
        }
      }
</style>      
</head>
<body>
    
    <video autoplay muted loop id="bg-video" style="position: absolute; top: 0; left: 0; width: 100%; height: 100%; object-fit: cover; z-index: -1;">
        <source src="two.mp4" type="video/mp4">
        Your browser does not support HTML5 video.
      </video>
      
    
    <div class="left-heading">
        <h1>Welcome to Legal Assistant Chatbot</h1>
        <p>Ask legal questions or upload a document to get a summary of key legal points.</p>
        <a href="/" class="cta-button">
            <!-- <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="button-icon">
              <path d="M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"></path>
            </svg> -->
            <span class="emoji-icon">üèõÔ∏è</span> 
            Return to Home Page
          </a>
        
      </div>
    <div id="chatbot-container">
        <div id="chatbot-header">Legal Assistant</div>
        <div id="chatbot-messages"></div>
        <div id="chatbot-input-container">
            <div class="input-row">
                <input type="text" id="chatbot-input" placeholder="Ask your legal question..." />
                <button id="chatbot-send">‚Üí</button>
            </div>
            <div id="file-upload-container">
                <label for="file-upload" id="file-upload-label">Upload Document</label>
                <input type="file" id="file-upload" accept=".pdf,.doc,.docx,.txt" />
                <div id="file-name"></div>
            </div>
        </div>
        <div class="legal-disclaimer">
            Note: This chatbot provides general legal information only, not professional legal advice.
        </div>
    </div>
</div class="main-container">
    <!-- Include PDF.js library for PDF text extraction -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/2.10.377/pdf.min.js"></script>
    <script>
        // Set PDF.js worker path
        pdfjsLib.GlobalWorkerOptions.workerSrc = 'https://cdnjs.cloudflare.com/ajax/libs/pdf.js/2.10.377/pdf.worker.min.js';

        // Compiled TypeScript to JavaScript
        var LegalChatbot = /** @class */ (function () {
            function LegalChatbot(containerId) {
                this.isDragging = false;
                this.dragStartX = 0;
                this.dragStartY = 0;
                this.initialX = 20;
                this.initialY = 20;
                this.apiKey = "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";
                this.model = "qwen/qwen2.5-vl-72b-instruct:free";
                this.container = document.getElementById(containerId);
                this.messagesContainer = this.container.querySelector('#chatbot-messages');
                this.inputField = this.container.querySelector('#chatbot-input');
                this.sendButton = this.container.querySelector('#chatbot-send');
                this.header = this.container.querySelector('#chatbot-header');
                this.fileUpload = this.container.querySelector('#file-upload');
                this.fileNameDisplay = this.container.querySelector('#file-name');
                this.init();
            }
            LegalChatbot.prototype.init = function () {
                var _this = this;
                this.addWelcomeMessage();
                this.sendButton.addEventListener('click', function () { return _this.handleSendMessage(); });
                this.inputField.addEventListener('keypress', function (e) {
                    if (e.key === 'Enter') {
                        _this.handleSendMessage();
                    }
                });
                this.fileUpload.addEventListener('change', function (e) { return _this.handleFileUpload(e); });
                this.setupDrag();
            };
            LegalChatbot.prototype.addWelcomeMessage = function () {
                var welcomeMessage = "Hello, I'm your Legal Assistant. I can help with:\n\n‚Ä¢ Contract law questions\n‚Ä¢ Property law matters\n‚Ä¢ Employment law issues and many more \n\nYou can upload legal documents (PDF, DOC, DOCX, TXT) and I'll summarize the key legal points.\n\nPlease note: I provide general legal information, not professional advice. How may I assist you today?";
                this.addMessage(welcomeMessage, 'bot');
            };
            LegalChatbot.prototype.addMessage = function (content, sender) {
                var messageElement = document.createElement('div');
                messageElement.classList.add('message');
                if (sender === 'bot') {
                    messageElement.classList.add('bot-message');
                    // Check if content is a document summary
                    if (content.startsWith('DOCUMENT SUMMARY:')) {
                        var summaryContent = content.replace('DOCUMENT SUMMARY:', '').trim();
                        var summaryElement = document.createElement('div');
                        summaryElement.classList.add('document-summary');
                        summaryElement.innerHTML = '<h4>Document Summary</h4>' + this.formatLegalResponse(summaryContent);
                        messageElement.appendChild(summaryElement);
                    } else {
                        // Convert numbered points to list items if not already in HTML format
                        if (!content.includes('<') && (content.includes('1.') || content.includes('‚Ä¢'))) {
                            var htmlContent = content.replace(/\n\s*\n/g, '</li><li>')
                                .replace(/(\d+\.|\‚Ä¢)\s+/g, '</li><li>')
                                .replace(/<\/li><li>/g, '<li>');
                            if (htmlContent.startsWith('<li>')) {
                                htmlContent = '<ul>' + htmlContent + '</ul>';
                            }
                            messageElement.innerHTML = htmlContent;
                        } else {
                            messageElement.textContent = content;
                        }
                    }
                } else {
                    messageElement.classList.add('user-message');
                    messageElement.textContent = content;
                }
                this.messagesContainer.appendChild(messageElement);
                this.messagesContainer.scrollTop = this.messagesContainer.scrollHeight;
            };
            LegalChatbot.prototype.showLoading = function () {
                var loadingElement = document.createElement('div');
                loadingElement.classList.add('loading-dots');
                loadingElement.innerHTML = '<div></div><div></div><div></div>';
                this.messagesContainer.appendChild(loadingElement);
                this.messagesContainer.scrollTop = this.messagesContainer.scrollHeight;
                return loadingElement;
            };
            LegalChatbot.prototype.hideLoading = function (loadingElement) {
                if (loadingElement && loadingElement.parentNode) {
                    loadingElement.parentNode.removeChild(loadingElement);
                }
            };
            LegalChatbot.prototype.handleSendMessage = function () {
                var _this = this;
                var message = this.inputField.value.trim();
                if (message) {
                    this.addMessage(message, 'user');
                    this.inputField.value = '';
                    var loadingElement = this.showLoading();
                    this.sendToLegalAPI(message)
                        .then(function (response) {
                        _this.hideLoading(loadingElement);
                        if (response) {
                            _this.addMessage(response, 'bot');
                        }
                    })
                        .catch(function (error) {
                        _this.hideLoading(loadingElement);
                        _this.addMessage("I apologize, I encountered an error processing your legal query. Please try again or consult a qualified attorney for specific advice.", 'bot');
                        console.error('Error:', error);
                    });
                }
            };
            LegalChatbot.prototype.handleFileUpload = function (event) {
                var _this = this;
                var file = event.target.files[0];
                if (!file) return;
                
                this.fileNameDisplay.textContent = file.name;
                this.addMessage("Uploaded document: " + file.name, 'user');
                
                var loadingElement = this.showLoading();
                
                // Process different file types
                if (file.type === 'application/pdf') {
                    this.extractTextFromPDF(file)
                        .then(function (text) {
                        return _this.processDocument(text, 'PDF Document');
                    })
                        .then(function (summary) {
                        _this.hideLoading(loadingElement);
                        _this.addMessage("DOCUMENT SUMMARY: " + summary, 'bot');
                        _this.fileUpload.value = '';
                        _this.fileNameDisplay.textContent = '';
                    })
                        .catch(function (error) {
                        _this.hideLoading(loadingElement);
                        _this.addMessage("Failed to process the PDF document. Please try again.", 'bot');
                        console.error('PDF processing error:', error);
                    });
                } else if (file.type === 'application/msword' || 
                         file.type === 'application/vnd.openxmlformats-officedocument.wordprocessingml.document') {
                    this.addMessage("Word document processing requires server-side support. For demo purposes, please use PDF or text files.", 'bot');
                    _this.hideLoading(loadingElement);
                    _this.fileUpload.value = '';
                    _this.fileNameDisplay.textContent = '';
                } else {
                    // Handle text files
                    var reader = new FileReader();
                    reader.onload = function (e) {
                        _this.processDocument(e.target.result, 'Text Document')
                            .then(function (summary) {
                            _this.hideLoading(loadingElement);
                            _this.addMessage("DOCUMENT SUMMARY: " + summary, 'bot');
                            _this.fileUpload.value = '';
                            _this.fileNameDisplay.textContent = '';
                        })
                            .catch(function (error) {
                            _this.hideLoading(loadingElement);
                            _this.addMessage("Failed to process the document. Please try again.", 'bot');
                            console.error('Document processing error:', error);
                        });
                    };
                    reader.onerror = function () {
                        _this.hideLoading(loadingElement);
                        _this.addMessage("Error reading the document. Please try again.", 'bot');
                    };
                    reader.readAsText(file);
                }
            };
            LegalChatbot.prototype.extractTextFromPDF = function (file) {
                return __awaiter(this, void 0, void 0, function () {
                    var arrayBuffer, pdf, text, _i, _a, page, pageText;
                    return __generator(this, function (_b) {
                        switch (_b.label) {
                            case 0: return [4 /*yield*/, file.arrayBuffer()];
                            case 1:
                                arrayBuffer = _b.sent();
                                return [4 /*yield*/, pdfjsLib.getDocument(arrayBuffer).promise];
                            case 2:
                                pdf = _b.sent();
                                text = '';
                                _i = 0, _a = Array(pdf.numPages).keys();
                                _b.label = 3;
                            case 3:
                                if (!(_i < _a.length)) return [3 /*break*/, 6];
                                page = _a[_i];
                                return [4 /*yield*/, pdf.getPage(page + 1)];
                            case 4:
                                return [4 /*yield*/, (_b.sent()).getTextContent()];
                            case 5:
                                pageText = _b.sent();
                                text += pageText.items.map(function (item) { return item.str; }).join(' ') + '\n';
                                _i++;
                                return [3 /*break*/, 3];
                            case 6: return [2 /*return*/, text];
                        }
                    });
                });
            };
            LegalChatbot.prototype.processDocument = function (content, fileType) {
                return __awaiter(this, void 0, void 0, function () {
                    var extractedText, response, data, error_1;
                    return __generator(this, function (_a) {
                        switch (_a.label) {
                            case 0:
                                _a.trys.push([0, 3, , 4]);
                                // Limit to first 5000 characters to avoid API limits
                                extractedText = content.length > 5000 ? content.substring(0, 5000) + "\n\n[Document truncated due to length limitations]" : content;
                                return [4 /*yield*/, fetch("https://openrouter.ai/api/v1/chat/completions", {
                                        method: "POST",
                                        headers: {
                                            "Authorization": "Bearer ".concat(this.apiKey),
                                            "HTTP-Referer": window.location.href,
                                            "X-Title": document.title,
                                            "Content-Type": "application/json"
                                        },
                                        body: JSON.stringify({
                                            "model": this.model,
                                            "messages": [
                                                {
                                                    "role": "system",
                                                    "content": "You are a professional legal assistant. Analyze the provided legal document and summarize the key legal facts, clauses, and implications in clear bullet points. Focus on:\n1. Parties involved\n2. Key obligations\n3. Important dates/deadlines\n4. Termination clauses\n5. Liability provisions\n6. Governing law\n7. Any unusual or noteworthy clauses\n\nFormat with clear headings for each section. Highlight potential red flags."
                                                },
                                                {
                                                    "role": "user",
                                                    "content": "Please analyze this " + fileType + " and provide a legal summary:\n\n" + extractedText
                                                }
                                            ]
                                        })
                                    })];
                            case 1:
                                response = _a.sent();
                                return [4 /*yield*/, response.json()];
                            case 2:
                                data = _a.sent();
                                if (data.choices && data.choices[0] && data.choices[0].message) {
                                    return [2 /*return*/, this.formatLegalResponse(data.choices[0].message.content)];
                                }
                                else {
                                    console.error('Unexpected API response:', data);
                                    return [2 /*return*/, "Could not generate a proper summary of this document."];
                                }
                                return [3 /*break*/, 4];
                            case 3:
                                error_1 = _a.sent();
                                console.error('API Error:', error_1);
                                throw error_1;
                            case 4: return [2 /*return*/];
                        }
                    });
                });
            };
            LegalChatbot.prototype.sendToLegalAPI = function (message) {
                return __awaiter(this, void 0, void 0, function () {
                    var legalPrompt, response, data, error_2;
                    return __generator(this, function (_a) {
                        switch (_a.label) {
                            case 0:
                                _a.trys.push([0, 3, , 4]);
                                legalPrompt = "You are a legal expert assistant. Provide clear, concise legal information in bullet points unless specifically asked for paragraphs. " + 
                                    "Focus on Indian law but mention if the information applies generally. " + 
                                    "If the question is not legal-related, politely decline to answer. " + 
                                    "Always remind users this is general information, not legal advice. " + 
                                    "Question: " + message;
                                return [4 /*yield*/, fetch("https://openrouter.ai/api/v1/chat/completions", {
                                        method: "POST",
                                        headers: {
                                            "Authorization": "Bearer ".concat(this.apiKey),
                                            "HTTP-Referer": window.location.href,
                                            "X-Title": document.title,
                                            "Content-Type": "application/json"
                                        },
                                        body: JSON.stringify({
                                            "model": this.model,
                                            "messages": [
                                                {
                                                    "role": "system",
                                                    "content": "You are a professional legal assistant specializing in Indian law. Provide information in clear bullet points unless asked for paragraphs. Always clarify that this is general information, not legal advice. If a question is outside legal scope, politely decline."
                                                },
                                                {
                                                    "role": "user",
                                                    "content": message
                                                }
                                            ]
                                        })
                                    })];
                            case 1:
                                response = _a.sent();
                                return [4 /*yield*/, response.json()];
                            case 2:
                                data = _a.sent();
                                if (data.choices && data.choices[0] && data.choices[0].message) {
                                    return [2 /*return*/, this.formatLegalResponse(data.choices[0].message.content)];
                                }
                                else {
                                    console.error('Unexpected API response:', data);
                                    return [2 /*return*/, "I couldn't process that legal request. The response format was unexpected."];
                                }
                                return [3 /*break*/, 4];
                            case 3:
                                error_2 = _a.sent();
                                console.error('API Error:', error_2);
                                throw error_2;
                            case 4: return [2 /*return*/];
                        }
                    });
                });
            };
            LegalChatbot.prototype.formatLegalResponse = function (response) {
                // Convert numbered lists to bullet points
                response = response.replace(/\n\d+\./g, '\n‚Ä¢');
                // Ensure the response ends with a disclaimer if it doesn't already have one
                if (!response.includes("Note:") && !response.includes("Disclaimer:")) {
                    response += "\n\nNote: This is general legal information, not professional advice. Consult a qualified attorney for your specific situation.";
                }
                return response;
            };
            LegalChatbot.prototype.setupDrag = function () {
                var _this = this;
                this.header.addEventListener('mousedown', function (e) {
                    _this.isDragging = true;
                    _this.dragStartX = e.clientX - _this.container.offsetLeft;
                    _this.dragStartY = e.clientY - _this.container.offsetTop;
                    _this.container.style.cursor = 'grabbing';
                });
                document.addEventListener('mousemove', function (e) {
                    if (!_this.isDragging) return;
                    e.preventDefault();
                    var newX = e.clientX - _this.dragStartX;
                    var newY = e.clientY - _this.dragStartY;
                    // Boundary checks
                    newX = Math.max(0, Math.min(newX, window.innerWidth - _this.container.offsetWidth));
                    newY = Math.max(0, Math.min(newY, window.innerHeight - _this.container.offsetHeight));
                    _this.container.style.left = newX + 'px';
                    _this.container.style.top = newY + 'px';
                });
                document.addEventListener('mouseup', function () {
                    _this.isDragging = false;
                    _this.container.style.cursor = 'default';
                });
            };
            return LegalChatbot;
        }());
        function __awaiter(thisArg, _arguments, P, generator) {
            function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }
            return new (P || (P = Promise))(function (resolve, reject) {
                function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }
                function rejected(value) { try { step(generator["throw"](value)); } catch (e) { reject(e); } }
                function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }
                step((generator = generator.apply(thisArg, _arguments || [])).next());
            });
        }
        function __generator(thisArg, body) {
            var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;
            return g = { next: verb(0), "throw": verb(1), "return": verb(2) }, typeof Symbol === "function" && (g[Symbol.iterator] = function() { return this; }), g;
            function verb(n) { return function (v) { return step([n, v]); }; }
            function step(op) {
                if (f) throw new TypeError("Generator is already executing.");
                while (g && (g = 0, op[0] && (_ = 0)), _) try {
                    if (f = 1, y && (t = op[0] & 2 ? y["return"] : op[0] ? y["throw"] || ((t = y["return"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;
                    if (y = 0, t) op = [op[0] & 2, t.value];
                    switch (op[0]) {
                        case 0: case 1: t = op; break;
                        case 4: _.label++; return { value: op[1], done: false };
                        case 5: _.label++; y = op[1]; op = [0]; continue;
                        case 7: op = _.ops.pop(); _.trys.pop(); continue;
                        default:
                            if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }
                            if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }
                            if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }
                            if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }
                            if (t[2]) _.ops.pop();
                            _.trys.pop(); continue;
                    }
                    op = body.call(thisArg, _);
                } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }
                if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };
            }
        }
        // Initialize the chatbot when the page loads
        document.addEventListener('DOMContentLoaded', function () {
            new LegalChatbot('chatbot-container');
            // Position the chatbot initially
            var chatbot = document.getElementById('chatbot-container');
            chatbot.style.position = 'fixed';
            chatbot.style.right = '20px';
            chatbot.style.bottom = '20px';
        });
    </script>
</body>
</html>